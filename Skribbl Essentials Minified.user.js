// ==UserScript==
// @name         Skribbl Essentials 2.2
// @match        *://skribbl.io/*
// @author       Databones
// @description  Provides a list of potential words for skribbl.io
// @icon         https://raw.githubusercontent.com/Databones/SkribblEssentials/main/logoGIF.gif
// @version      2.2
// @license      MIT
// @namespace    skribblessentials
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_addStyle
// ==/UserScript==

// ‚îÄ‚îÄ  FEATURES  ‚îÄ‚îÄ
// üìÑ Suggestions tab: Generate a list of potential guesses.
// üñºÔ∏è Themes: Customize the background to your liking.
// üì¶ Compact chat: Have the chat more instant and compact.
// üíæ Saveable private room settings: Save and load the settings you use for private rooms.
// üé© Hats: Allows you to wear hats seen by other players using only ASCII characters
// #Ô∏è‚É£ Special character usernames: Allows you to use all special characters by spoofing with lookalikes.
// üî§ Fixed character limit: Enjoy an extended 14-character username.

!function(){"use strict";fetch("https://raw.githubusercontent.com/Databones/SkribblEssentials/main/version").then((t=>t.text())).then((t=>{const e=GM_info.script.version;t.trim()!==e.trim()&&(window.location.href="https://github.com/Databones/SkribblEssentials/raw/main/Skribbl Essentials.user.js")})),function(t){const e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}("\n  .powered-by-skribbl-essentials {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    font: inherit;\n    margin-top: 10px;\n  }\n");const t=document.createElement("a");t.href="https://github.com/Databones/SkribblEssentials",t.target="_blank",t.style.textDecoration="none";const e=document.createElement("div");e.className="powered-by-skribbl-essentials",e.style.userSelect="none",e.style.pointerEvents="none",e.innerHTML='\n  Powered by Skribbl Essentials 2.1\n  <img src="https://raw.githubusercontent.com/Databones/SkribblEssentials/main/logoGIF.gif" alt="Skribbl Essentials Icon" style="width: 25px; margin-left: 5px;">\n',t.appendChild(e);const n=document.querySelector("div.logo-big");function a(t,e){const n=new Image;n.src=t,n.onload=function(){const e=n.width===n.height;document.body.style.backgroundImage=`url(${t})`,document.body.style.backgroundRepeat=e?"repeat":"no-repeat",document.body.style.backgroundSize=e?"auto":"cover";document.querySelectorAll('svg[viewBox="0 0 1 1"][preserveAspectRatio="none"]').forEach((t=>{t.remove();const e=document.createElement("style");e.innerHTML=":root { --COLOR_PANEL_BG: rgba(12, 44, 150, 0.0) !important; }",document.head.appendChild(e)}))}}function o(){const t=prompt("Enter the image URL:");t&&(GM_setValue("backgroundImageURL",t),GM_setValue("backgroundRepeat",!1),a(t))}function s(){const t="/img/background.png";a(t),GM_setValue("backgroundImageURL",t),GM_setValue("backgroundRepeat",true)}function r(){const t=!GM_getValue("suggestions",!0);GM_setValue("suggestions",t),c(t),window.location.reload()}function i(){const t=!GM_getValue("compactChat",!1);GM_setValue("compactChat",t),l(t),window.location.reload()}function c(t){const e=document.getElementById("suggestionsToggleButton");e.style.backgroundColor=t?"green":"red"}function l(t){const e=document.getElementById("compactChatToggleButton");e.style.backgroundColor=t?"green":"red"}n&&n.appendChild(t);document.querySelectorAll(".section-container").forEach((t=>{for(;t.firstChild;)t.removeChild(t.firstChild);const e=[d("Add custom background",o),d("Reset",s)],n=d("Suggestions Tab",r);n.id="suggestionsToggleButton",e.push(n);const a=d("Compact Chat",i);a.id="compactChatToggleButton",e.push(a),e.forEach((e=>t.appendChild(e)))}));const u=GM_getValue("backgroundImageURL");GM_getValue("backgroundRepeat");u&&a(u);c(GM_getValue("suggestions",!0));function d(t,e){const n=document.createElement("button");return n.textContent=t,Object.assign(n.style,{borderRadius:"5px",padding:"5 5px",margin:"10 5px",color:"black"}),n.addEventListener("click",e),n}l(GM_getValue("compactChat",!1)),document.addEventListener("change",(t=>{if(t.target.matches("select, input[type='checkbox'], textarea")){!function(t,e){GM_setValue(t,e)}(t.target.id,"checkbox"===t.target.type?t.target.checked?"on":"off":t.target.value)}}));new MutationObserver((function(){document.querySelector("div.room.show")&&function(){const t=["item-settings-rounds","item-settings-slots","item-settings-language","item-settings-drawtime","item-settings-wordcount","item-settings-hints"];for(const e of t){const t=GM_getValue(e);if(void 0!==t){const n=document.getElementById(e);if(n&&"SELECT"===n.tagName){n.value=t;const e=new Event("change",{bubbles:!0});n.dispatchEvent(e)}}}const e=document.getElementById("item-settings-customwordsonly");if(e){const t=GM_getValue("item-settings-customwordsonly");void 0!==t&&(e.checked="on"===t,e.dispatchEvent(new Event("change",{bubbles:!0})))}const n=document.getElementById("item-settings-customwords");if(n&&"true"!==n.dataset.loaded){const t=GM_getValue("item-settings-customwords");void 0!==t&&(n.value=t,n.dispatchEvent(new Event("input",{bubbles:!0})),n.dataset.loaded="true")}}()})).observe(document,{childList:!0,subtree:!0});GM_getValue("compactChat",!1)&&GM_addStyle("\n            #game-chat .chat-container .chat-content p {\n                padding: 0 !important;\n                animation: none !important;\n                transition: none !important;\n            }\n        ");const m={dz:"«≥","\\.":"‚Ä§",Dz:"«≤",DZ:"«±",LJ:"«á",Lj:"«à",lj:"«â",NJ:"«ä",Nj:"«ã",nj:"«å","\\$":"ÔºÑ","#":"‚µå","%":"ÔºÖ","&":"ÔºÜ","Ôºä":"*","\\(":"Ôºà","\\)":"Ôºâ","\\+":"Ôºã",",":"Ôºå","\\/":"Ôºè","\\\\":"Ôºº",":":"◊É","\\?":"Ôºü","\\{":"ÔΩõ","ÔΩù":"}","<":"·ê∏",">":"·ê≥","'":"’ö",'"':"‚Äü"};const g=document.querySelector('input.input-name[type="text"][placeholder="Enter your name"]');function p(){const t=document.querySelector("div.player-name.me");t&&(t.classList.remove("me"),t.classList.add("player-name"),t.textContent=t.textContent.replace(" (You)",""))}g&&g.addEventListener("input",(function(t){const e=t.target;let n=e.value;for(const t in m)if(m.hasOwnProperty(t)){const e=new RegExp(t,"g");n=n.replace(e,m[t])}e.value=n}));const b=new MutationObserver((t=>{for(const e of t)"childList"===e.type&&p()})),h=document.body;b.observe(h,{childList:!0,subtree:!0});const v=[{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Eyeball.png",avatarData:[0,3,0],name:"«±«±«±‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉüëÅüëÅ",partsToChange:[1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Dark.png",avatarData:[0,26,0],name:"Ôæ†Ôæ†‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚¨§‚¨§",partsToChange:[1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Creepy.png",avatarData:[0,42,0],name:"Ôæ†Ôæ†‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚óâ‚óâ",partsToChange:[1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Pupils.png",avatarData:[0,35,0],name:"Ôæ†Ôæ†‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚¨§‚¨§",partsToChange:[1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Nose.png",avatarData:[0,0,0],name:"Ôæ†Ôæ†‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉüëÉ",partsToChange:[-1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/PigSnout.png",avatarData:[0,0,0],name:"Ôæ†Ôæ†‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉüêΩ",partsToChange:[-1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Sweat.png",avatarData:[0,0,0],name:"„Ö§‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ„Ö§üíß",partsToChange:[-1]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Lips.png",avatarData:[0,0,6],name:"Ôæ†Ôæ†‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉüëÑ",partsToChange:[2]},{imageUrl:"https://raw.githubusercontent.com/Databones/SkribblEssentials/main/avatars/Stars.png",avatarData:[0,0,0],name:"„Ö§‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ú®",partsToChange:[-1]}],f=document.querySelectorAll(".panel-right .ad-side");for(const t of f)t.parentElement.removeChild(t);function y(t){const e=JSON.parse(localStorage.getItem("ava"));t.partsToChange.forEach((n=>{e[n]=t.avatarData[n]})),localStorage.setItem("ava",JSON.stringify(e)),t.name&&localStorage.setItem("name",t.name),window.location.reload()}const E=document.querySelector(".panel-right");for(let t=0;t<3;t++){const e=document.createElement("div");e.className="avatar-row";for(let n=0;n<5;n++){const a=5*t+n;if(a<v.length){const t=v[a],n=document.createElement("button");n.style.cursor="pointer";const o=document.createElement("img");o.src=t.imageUrl,o.draggable=!1,o.style.userSelect="none",n.style="\n                width: 92px;\n                height: 111px;\n                padding: 10px;\n                background-color: transparent;\n                border: none;\n                margin: 5px;\n            ",n.appendChild(o),n.addEventListener("click",(()=>{y(t)})),e.appendChild(n)}}E.appendChild(e)}if(!GM_getValue("suggestions",!0))return;const w=document.querySelector("form"),C=document.querySelector('form input[placeholder="Type your guess here..."]'),S=document.querySelector(".chat-content"),k=document.querySelector(".hints .container"),L=document.createElement("div");L.className="suggestions",L.style.maxHeight="150px",L.style.overflowY="auto",w.appendChild(L);const x=new Set;let D,T=[];function M(){const t=C.value.toLowerCase(),e=k.querySelectorAll(".hint"),n=Array.from(e).map((t=>t.classList.contains("uncover")?t.textContent:t.textContent.replace(/_/g,"[^\\s-]"))).join(""),a=new RegExp(`^${n}$`,"i"),o=S.querySelectorAll('p[style*="var(--COLOR_CHAT_TEXT_BASE)"] span'),s=Array.from(o).map((t=>t.textContent.trim())),r=T.filter((t=>a.test(t)&&!s.includes(t.toLowerCase())&&!x.has(t.toLowerCase())));L.innerHTML="";const i=document.createDocumentFragment();r.forEach((e=>{if(e.toLowerCase().includes(t)){const t=document.createElement("button");t.textContent=e,t.style.color="black",t.style.margin="5px",t.style.borderRadius="5px",t.style.userSelect="none",i.appendChild(t)}})),L.appendChild(i)}C.addEventListener("input",(()=>{clearTimeout(D),D=setTimeout(M,50)})),L.addEventListener("mousedown",(t=>{if("BUTTON"===t.target.tagName){t.preventDefault();const e=t.target.textContent.toLowerCase();C.value=e,x.add(e);const n=new Event("input",{bubbles:!0,cancelable:!0});C.dispatchEvent(n);const a=new Event("submit",{bubbles:!0,cancelable:!0});w.dispatchEvent(a)}}));new MutationObserver(M).observe(k,{subtree:!0,childList:!0});new MutationObserver(M).observe(S,{childList:!0,subtree:!0}),function(){const t=localStorage.getItem("wordListData");if(t){const{timestamp:e,data:n}=JSON.parse(t);if((new Date).getTime()-e<=864e5)return T=n.split("\n"),!0}return!1}()||fetch("https://raw.githubusercontent.com/Databones/SkribblEssentials/main/wordList").then((t=>t.text())).then((t=>{const e=(new Date).getTime();localStorage.setItem("wordListData",JSON.stringify({timestamp:e,data:t})),T=t.split("\n"),M()})).catch((t=>{console.error("Error fetching data:",t)})),M(),window.addEventListener("load",(function(){document.querySelectorAll('input.input-name[data-translate="placeholder"]').forEach((t=>t.setAttribute("maxlength","14")))})),window.addEventListener("load",p)}();
